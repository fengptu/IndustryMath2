<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>บทเรียนการอินทิเกรตและแบบทดสอบ</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 20px;
            background-color: #f4f4f4;
        }
        .container {
            max-width: 800px;
            margin: auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        h1, h2, h3 {
            color: #333;
        }
        .latex-formula {
            display: block;
            text-align: center;
            margin: 20px 0;
            font-size: 1.5em;
        }
        /* Style for the quiz */
        .quiz-container {
            margin-top: 30px;
        }
        .question-container {
            background-color: #e9e9e9;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: none; /* ซ่อนทุกข้อไว้ก่อน */
        }
        .options-list {
            list-style-type: none;
            padding: 0;
        }
        .options-list li {
            margin-bottom: 10px;
        }
        .options-list label {
            cursor: pointer;
            display: block;
            padding: 10px;
            background-color: #fff;
            border: 1px solid #ddd;
            border-radius: 4px;
            transition: background-color 0.3s;
        }
        .options-list label:hover {
            background-color: #f1f1f1;
        }
        .options-list input[type="radio"] {
            margin-right: 10px;
        }
        .nav-button {
            padding: 10px 20px;
            background-color: #0d6efd;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            margin-top: 15px;
        }
        .nav-button:hover {
            background-color: #0b5ed7;
        }
        
        /* Style for the results summary */
        .results-container {
            display: none;
            background-color: #fff3cd;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #ffecb5;
        }
        .result-item {
            padding: 10px;
            border-bottom: 1px solid #ddd;
        }
        .result-item.correct {
            color: #0f5132;
        }
        .result-item.incorrect {
            color: #842029;
        }
        .summary {
            font-size: 1.5em;
            text-align: center;
            margin-bottom: 20px;
        }
        .summary-score {
            font-size: 2em;
            font-weight: bold;
            color: #198754;
        }
    </style>
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
            "HTML-CSS": { linebreaks: { automatic: true } },
            "SVG": { linebreaks: { automatic: true } }
        });
    </script>
</head>
<body>

<div class="container">
    <h1>บทเรียน: การอินทิเกรตเบื้องต้น</h1>
    <p>สวัสดีเพื่อน! วันนี้เราจะมาเรียนรู้เรื่องการอินทิเกรต (Integration) กันนะ...</p>
    </div>

<div class="container">
    <h2>แบบทดสอบ: การอินทิเกรต</h2>
    <p>แบบทดสอบมีทั้งหมด 5 ข้อ เมื่อทำครบทุกข้อจะแสดงผลลัพธ์ให้ทราบครับ</p>

    <div class="quiz-container">
        <div class="question-container" id="question-1">
            <h3>คำถามที่ 1</h3>
            <p>จงหาค่าของอินทิกรัลไม่จำกัดเขต: $$ \int (3x^2 + 4x - 5) \,dx $$</p>
            <ul class="options-list">
                <li><label><input type="radio" name="q1_option" value="a">ก. $x^3 + 2x^2 - 5x + C$</label></li>
                <li><label><input type="radio" name="q1_option" value="b">ข. $3x^3 + 4x^2 - 5x + C$</label></li>
                <li><label><input type="radio" name="q1_option" value="c">ค. $6x + 4$</label></li>
                <li><label><input type="radio" name="q1_option" value="d">ง. $x^3 + 2x^2 - 5x$</label></li>
            </ul>
            <button class="nav-button" onclick="handleAnswer(1)">ข้อต่อไป</button>
        </div>

        <div class="question-container" id="question-2">
            <h3>คำถามที่ 2</h3>
            <p>จงหาค่าของอินทิกรัลจำกัดเขต: $$ \int_0^2 (2x + 1) \,dx $$</p>
            <ul class="options-list">
                <li><label><input type="radio" name="q2_option" value="a">ก. $6$</label></li>
                <li><label><input type="radio" name="q2_option" value="b">ข. $5$</label></li>
                <li><label><input type="radio" name="q2_option" value="c">ค. $3$</label></li>
                <li><label><input type="radio" name="q2_option" value="d">ง. $4$</label></li>
            </ul>
            <button class="nav-button" onclick="handleAnswer(2)">ข้อต่อไป</button>
        </div>

        <div class="question-container" id="question-3">
            <h3>คำถามที่ 3</h3>
            <p>ถ้า $F'(x) = 4x^3$ และ $F(1) = 5$ จงหา $F(x)$</p>
            <ul class="options-list">
                <li><label><input type="radio" name="q3_option" value="a">ก. $x^4 + 4$</label></li>
                <li><label><input type="radio" name="q3_option" value="b">ข. $x^4 + C$</label></li>
                <li><label><input type="radio" name="q3_option" value="c">ค. $x^4$</label></li>
                <li><label><input type="radio" name="q3_option" value="d">ง. $12x^2$</label></li>
            </ul>
            <button class="nav-button" onclick="handleAnswer(3)">ข้อต่อไป</button>
        </div>

        <div class="question-container" id="question-4">
            <h3>คำถามที่ 4</h3>
            <p>การอินทิเกรต $ \int \sin(x) \,dx $ ได้ผลลัพธ์ตรงกับข้อใด</p>
            <ul class="options-list">
                <li><label><input type="radio" name="q4_option" value="a">ก. $-\cos(x) + C$</label></li>
                <li><label><input type="radio" name="q4_option" value="b">ข. $\cos(x) + C$</label></li>
                <li><label><input type="radio" name="q4_option" value="c">ค. $-\sin(x) + C$</label></li>
                <li><label><input type="radio" name="q4_option" value="d">ง. $\sin(x) + C$</label></li>
            </ul>
            <button class="nav-button" onclick="handleAnswer(4)">ข้อต่อไป</button>
        </div>

        <div class="question-container" id="question-5">
            <h3>คำถามที่ 5</h3>
            <p>จงหาค่าของ $ \int_1^e \frac{1}{x} \,dx $</p>
            <ul class="options-list">
                <li><label><input type="radio" name="q5_option" value="a">ก. $1$</label></li>
                <li><label><input type="radio" name="q5_option" value="b">ข. $\ln(e)$</label></li>
                <li><label><input type="radio" name="q5_option" value="c">ค. $0$</label></li>
                <li><label><input type="radio" name="q5_option" value="d">ง. $-1$</label></li>
            </ul>
            <button class="nav-button" onclick="handleAnswer(5)">ดูผลลัพธ์</button>
        </div>

        <div class="results-container" id="results">
            <h3 class="summary">สรุปผลการทดสอบ</h3>
            <div id="score-display" class="summary"></div>
            <div id="results-list"></div>
        </div>
    </div>
</div>

<script>
    // Data for questions, answers, and rationales, including options text
    const quizData = {
        'q1': {
            question: 'จงหาค่าของอินทิกรัลไม่จำกัดเขต: $$ \\int (3x^2 + 4x - 5) \\,dx $$',
            options: { 'a': 'ก. $x^3 + 2x^2 - 5x + C$', 'b': 'ข. $3x^3 + 4x^2 - 5x + C$', 'c': 'ค. $6x + 4$', 'd': 'ง. $x^3 + 2x^2 - 5x$' },
            correct: 'a',
            rationale: '<b>เหตุผล:</b> ใช้กฎการอินทิเกรตพหุนาม: $\\int x^n \\,dx = \\frac{x^{n+1}}{n+1} + C$'
        },
        'q2': {
            question: 'จงหาค่าของอินทิกรัลจำกัดเขต: $$ \\int_0^2 (2x + 1) \\,dx $$',
            options: { 'a': 'ก. $6$', 'b': 'ข. $5$', 'c': 'ค. $3$', 'd': 'ง. $4$' },
            correct: 'a',
            rationale: '<b>เหตุผล:</b> อินทิเกรตได้ $x^2+x$ แล้วแทนค่า: $(2^2+2) - (0^2+0) = 6$'
        },
        'q3': {
            question: 'ถ้า $F\'(x) = 4x^3$ และ $F(1) = 5$ จงหา $F(x)$',
            options: { 'a': 'ก. $x^4 + 4$', 'b': 'ข. $x^4 + C$', 'c': 'ค. $x^4$', 'd': 'ง. $12x^2$' },
            correct: 'a',
            rationale: '<b>เหตุผล:</b> อินทิเกรต $4x^3$ ได้ $x^4+C$ ใช้ $F(1)=5$ จะได้ $1^4+C=5$ ดังนั้น $C=4$'
        },
        'q4': {
            question: 'การอินทิเกรต $ \\int \\sin(x) \\,dx $ ได้ผลลัพธ์ตรงกับข้อใด',
            options: { 'a': 'ก. $-\\cos(x) + C$', 'b': 'ข. $\\cos(x) + C$', 'c': 'ค. $-\\sin(x) + C$', 'd': 'ง. $\\sin(x) + C$' },
            correct: 'a',
            rationale: '<b>เหตุผล:</b> อนุพันธ์ของ $-\\cos(x)$ คือ $\\sin(x)$'
        },
        'q5': {
            question: 'จงหาค่าของ $ \\int_1^e \\frac{1}{x} \\,dx $',
            options: { 'a': 'ก. $1$', 'b': 'ข. $\\ln(e)$', 'c': 'ค. $0$', 'd': 'ง. $-1$' },
            correct: 'a',
            rationale: '<b>เหตุผล:</b> อินทิกรัลของ $1/x$ คือ $\\ln|x|$ แล้วแทนค่าขอบเขต $\\ln(e) - \\ln(1) = 1-0=1$'
        }
    };
    
    let userAnswers = {};
    const totalQuestions = 5;

    // A single function to handle user's answer and move to the next step
    function handleAnswer(qNumber) {
        const questionId = 'q' + qNumber;
        const selectedOption = document.querySelector(`input[name="${questionId}_option"]:checked`);
        
        if (!selectedOption) {
            alert('กรุณาเลือกคำตอบก่อนครับ');
            return;
        }

        userAnswers[questionId] = selectedOption.value;

        if (qNumber < totalQuestions) {
            // Hide current question and show the next one
            document.getElementById(`question-${qNumber}`).style.display = 'none';
            document.getElementById(`question-${qNumber + 1}`).style.display = 'block';
        } else {
            // If it's the last question, show results
            showResults();
        }
    }

    function showResults() {
        // Hide the quiz container
        document.querySelector('.quiz-container').style.display = 'none';
        
        // Show the results container
        const resultsContainer = document.getElementById('results');
        resultsContainer.style.display = 'block';

        let score = 0;
        const resultsList = document.getElementById('results-list');
        resultsList.innerHTML = '';

        for (let i = 1; i <= totalQuestions; i++) {
            const qId = 'q' + i;
            const userAnswer = userAnswers[qId];
            const correctAnswer = quizData[qId].correct;
            const isCorrect = userAnswer === correctAnswer;
            
            if (isCorrect) {
                score++;
            }
            
            const resultItem = document.createElement('div');
            resultItem.className = `result-item ${isCorrect ? 'correct' : 'incorrect'}`;
            
            // ดึงข้อความคำตอบจาก quizData object โดยตรง ซึ่งปลอดภัยกว่า
            const chosenOptionText = quizData[qId].options[userAnswer] || 'ไม่ได้เลือก';
            const correctOptionText = quizData[qId].options[correctAnswer] || 'ไม่พบคำตอบ';
            
            let resultHTML = `<b>คำถามที่ ${i}:</b> ${isCorrect ? '✅ ถูกต้อง' : '❌ ผิด'}<br>`;
            resultHTML += `<b>คำตอบของคุณ:</b> ${chosenOptionText}<br>`;
            resultHTML += `<b>คำตอบที่ถูกต้องคือ:</b> ${correctOptionText}<br>`;
            resultHTML += `${quizData[qId].rationale}`;

            resultItem.innerHTML = resultHTML;
            resultsList.appendChild(resultItem);
        }
        
        // Display the final score
        const scoreDisplay = document.getElementById('score-display');
        scoreDisplay.innerHTML = `คุณได้คะแนน <span class="summary-score">${score}</span>/${totalQuestions} คะแนน`;
        
        // Render MathJax in the results
        MathJax.Hub.Queue(["Typeset", MathJax.Hub, resultsContainer]);
    }

    // Initialize the quiz: show the first question when the page loads
    document.addEventListener('DOMContentLoaded', () => {
        document.getElementById('question-1').style.display = 'block';
    });
</script>

</body>
</html>
